---
layout: default
---

<div class="layout">
    <div class="layout-sidebar">
        <div class="sidebar">
            <div class="header">
                <h2 class="site-title">
                    <a href="{{ '/' | relative_url }}">{{ site.title }}</a>
                </h2>
                <div class="expand-btn">
                    <div>EXPAND ALL CATEGORIES</div>
                </div>
            </div>
            <div class="nav">
                Now Loading...
            </div>
            <div class="footer">
                <div>{{ site.bottom-msg }}</div>
            </div>
        </div>
    </div>
    <div class="layout-mainview">
        <div class="mainview">
            <div class="article">
                <h1 class="page-title">
                    {{ page.title }}
                </h1>
                <div class="page-desc">
                    Last updated:&nbsp;{{ page.updated }}
                </div>
                <div class="page-main">
                    {{ content }}
                </div>
                <div class="page-reply">
        
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var target = '{{ "/assets/nav.html" | relative_url  }}';
    fetch(target).then(function(response) {
        return response.text();
    }).then(function(body) {
        document.querySelector('.nav').innerHTML = body;
        return;
    }).then(function() {
        var sub_titles = document.querySelectorAll('.sub-title');

        for (var x of sub_titles) {
            x.addEventListener('click', function(e) {
                e.target.classList.toggle('opened');
                var id = e.target.getAttribute('sub');
                document.querySelectorAll(`.nav-posts-wrapper[sub="${id}"]`)[0].classList.toggle('opened');
            });
        }
    }).then(function() {
        var expand_btn = document.querySelectorAll('.expand-btn div')[0];
        var nav_posts_wrapper = document.querySelectorAll('.nav-posts-wrapper');

        expand_btn.addEventListener('click', function(e) {
            if (e.target.classList.contains('opened')) {
                e.target.classList.remove('opened');
                e.target.textContent = 'EXPAND ALL CATEGORIES';
                for (var x of nav_posts_wrapper) {
                    x.classList.remove('opened');
                    var sub = x.getAttribute('sub');
                    document.querySelectorAll(`.sub-title[sub="${sub}"]`)[0].classList.remove('opened');
                }
            } else {
                e.target.classList.add('opened');
                e.target.textContent = 'COLLAPSE ALL CATEGORIES';
                for (var x of nav_posts_wrapper) {
                    x.classList.add('opened');
                    var sub = x.getAttribute('sub');
                    document.querySelectorAll(`.sub-title[sub="${sub}"]`)[0].classList.add('opened');
                }
            }
        });
    }).then(function() {
        var cur = document.location.href.split('/');
        cur = '/post/' + cur[cur.length-1];
        var posts = document.querySelectorAll('.nav-post');

        if(cur !== '/post/') {
            for (var x of posts) {
                var href = x.firstElementChild.getAttribute('href');
                if (href == cur) {
                    x.classList.add('current');
                    var sub = x.getAttribute('sub');
                    document.querySelectorAll(`.nav-posts-wrapper[sub="${sub}"]`)[0].classList.add('opened');
                    document.querySelectorAll(`.sub-title[sub="${sub}"]`)[0].classList.add('opened');
                    document.querySelectorAll('.sidebar')[0].scrollTo(0, x.offsetTop - window.innerHeight/2);
                }
            }
        }
    });
</script>
